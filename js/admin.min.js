/*!
 * Skeleton Dashboard - Admin JS (https://github.com/ianhubnet/skeleton)
 * Copyright 2024 Kader Bouyakoub (http://bit.ly/KaderGhb)
 */ (function($,window,document,undefined){"use strict";var csk=window.csk=window.csk||{};csk.i18n=csk.i18n||{},"undefined"!=typeof bootbox&&(bootbox.setDefaults({backdrop:!0,closeButton:!1,locale:csk.config.lang.code,size:"small"}),bootbox.setLocale(csk.config.lang.code||"en")),csk.ui={confirm:function(message,trueCallback,falseCallback,elem){if((message.startsWith("lang:")||message.startsWith("i18n:"))&&void 0!==csk.i18n&&(message=eval("csk.i18n."+message.substring(5))||message),"object"==typeof elem){var name=elem.data("name")||elem.attr("aria-label");void 0!==name&&name.length&&(message=sprintf(message,name))}"undefined"!=typeof bootbox?bootbox.confirm({message:message,buttons:{confirm:{className:"btn btn-primary btn-sm"},cancel:{className:"btn btn-default btn-sm"}},callback:function(e){bootbox.hideAll(),!0===e&&"function"==typeof trueCallback?trueCallback(!0):"function"==typeof falseCallback&&falseCallback(!0)}}):confirm(message)&&"function"==typeof trueCallback?trueCallback(!0):"function"==typeof falseCallback&&falseCallback(!0)},alert:function(e,t){if(!e.length)return!1;if("error"===(t=t||"info")&&(t="danger"),"undefined"==typeof toastr)if("object"!=typeof Handlebars)alert(e.replace(/(<([^>]+)>)/gi,""));else{var n=$("#csk-alert"),a=document.getElementById("csk-alert-template").innerHTML,i=Handlebars.compile(a)({message:e,type:t});n.length?n.fadeOut((function(){$(this).remove(),$(i).prependTo("#wrapper > .container")})):$(i).prependTo("#wrapper > .container")}else switch(t){case"success":toastr.success(e);break;case"error":case"danger":toastr.error(e);break;case"warning":toastr.warning(e);break;default:toastr.info(e)}},reload:function(e,t,n){if(!(e=e||"#wrapper").length)return!1;!1!==t&&$("#navbar-admin").load(csk.config.currentURL+" #navbar-admin > *"),$(e).load(csk.config.currentURL+" "+e+" > *",n)},inViewport:function(e){var t=e.getBoundingClientRect();return t.bottom>=0&&t.right>=0&&t.top<=(window.innerHeight||document.documentElement.clientHeight)&&t.left<=(window.innerWidth||document.documentElement.clientWidth)},addListener:function(e,t){window.addEventListener?window.addEventListener(e,t):window.attachEvent("on"+e,t)},lazyLoad:function(){for(var e=$("[data-src]"),t=0;t<e.length;t++){var n=e[t];if(!csk.ui.inViewport(n)||"object"!=typeof n)return;$(n).is("img")?(n.src=n.getAttribute("data-src")||n.src,n.onload=function(){this.removeAttribute("data-src")}):"function"==typeof $(n).css&&($(n).css("background-image","url("+n.getAttribute("data-src")+")"),n.removeAttribute("data-src"))}},prepFields:function(e){for(var t,n={},a=e.split(";"),i=0;i<a.length;i++)n[(t=a[i].split(":"))[0]]=t[1];return n},getUrlParams:function(e){for(var t,n={},a=(e=e||window.location.href).slice(e.indexOf("?")+1).split("&"),i=0;i<a.length;i++)n[(t=a[i].split("="))[0]]=t[1];return n},getUrlParam:function(e){var t,n,a=window.location.search.substring(1).split("&");for(n=0;n<a.length;n++)if((t=a[n].split("="))[0]===e)return t[1]===undefined||decodeURIComponent(t[1]);return!1},clipboard:function(e){var t=e.getAttribute("data-text");if(void 0===t||!t.length)return!1;navigator.clipboard.writeText(t),csk.ui.alert(csk.i18n.media.copied,"success")}},csk.ui.addListener("load",csk.ui.lazyLoad),csk.ui.addListener("scroll",csk.ui.lazyLoad),csk.ajax={requests:[],requesting:!1,context:undefined,request:function(e,t){(t=t||{}).context;var n=t.type||"GET";t=$.extend({url:e,method:n,type:n,async:!0,cache:!1,dataType:"json",success:function(e,t,n){csk.ajax._response(e)},error:function(e,t,n){var a=e.responseJSON||undefined;void 0!==a&&"undefined"!==a.message&&a.message.length&&csk.ui.alert(a.message,"error")}},t),this.requests.push(t),this._execute()},stop:function(){this.requests=[]},_execute:function(){if(0!=this.requests.length&&1!=this.requesting){var e=this.requests.splice(0,1)[0],t=e.complete,n=this;e._execute&&e._execute(e),e.complete=function(){t&&t.apply(this,arguments),n.requesting=!1,n._execute()},this.requesting=!0,$.ajax(e)}},_response:function(e){e=e||{};if(csk.ajax.context=this,void 0!==e.message&&e.message.length&&csk.ui.alert(e.message,"success"),void 0!==e.scripts)for(var t=e.scripts.length,n=0;n<t;n++)try{new Function(e.scripts[n]).call(this)}catch(e){console.log(e)}}},csk.sendFile=function(e,t){var n=new FormData,a=$(t).attr("data-upload");if(void 0===a||!a.length)return!1;n.append("file",e),csk.ajax.request(a,{type:"POST",data:n,processData:!1,contentType:!1,complete:function(e,n){if("success"===n){var a=e.responseJSON;$(t).hasClass("summernote")&&$(t).summernote("insertImage",a.results.url),$("<input>").attr({type:"hidden",name:"medias[]",value:a.results.id}).appendTo(t),$(t).closest("form").find("[type=submit]").prop("disabled",!1).removeClass("disabled")}}})},csk.submit=function(e,t){var n=$("<form>",{action:e,method:"post"});$.each(t,(function(e,t){$("<input>").attr({type:"hidden",name:e,value:t}).appendTo(n)})),n.appendTo("body").submit()},csk.ping={init:function(e){return this.options=$.extend({url:"keep-alive",timer:6e5},e),csk.ping._ping.apply(this),this},stop:function(){this.nextPing&&clearTimeout(this.nextPing)},_ping:function(){var e=this;this.nextPing=setTimeout((function(){csk.ajax.request(e.options.url,{type:"POST"}),csk.ping._ping.apply(e)}),e.options.timer)}},$(document).ready((function(){$.fn.ping=function(e){return csk.ping[e]?csk.ping[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void $.error("The method "+e+" doesn't exist in $.fn.ping"):csk.ping.init.apply(this,arguments)},void 0!==csk.config&&$.fn.ping({url:csk.config.baseURL+"keep-alive",timer:18e5}),$(".alert-dismissible").each((function(){let e=$(this);if(e.hasClass("alert-keep")||e.hasClass("alert-danger")||e.hasClass("alert-warning"))return;let t=e.text().trim().length,n=Math.min(1e4,4e3+50*t);e.delay(n).slideUp(500,(function(){e.alert("close").remove()}))})),"undefined"!=typeof toastr?toastr.options={rtl:"rtl"===csk.config.lang.direction,closeButton:!0,positionClass:"toast-top-center",hideDuration:"300",timeOut:"2500",showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"}:void 0!==$.fn.toast&&$(".toast").each((function(){$(this).toast("show").on("hidden.bs.toast",(function(){$(this).remove()}))})),void 0!==$.fn.select2&&$("select.select2").each((function(){var e=$(this),t={width:"100%"};e.hasClass("select2-modal")&&(t.dropdownParent=$(".modal")),e.select2(t)})),void 0!==$.fn.DataTable&&$(".datatables").each((function(){$(this).DataTable({columnDefs:[{targets:"no-sort",orderable:!1}]})})),$(".custom-file-input").on("change",(function(){var e=$(this).val().split("\\").pop();$(this).siblings(".custom-file-label").addClass("selected").html(e)})),"object"==typeof $.ui&&$(".sortable").each((function(){var e=$(this);e.sortable({containment:".sortable",cursor:"move",tolrance:"pointer",scroll:!0,revert:100,opacity:.65,axis:e.data("axis")||"y",update:function(e,t){var n=$(".sortable-form");if("object"==typeof n){var a=$(this).sortable("toArray",{attribute:"data-id"});n.attr("data-fields","id:"+a.join(","))}}})}));var e=[];if($(document).on("change",".check-all",(function(){$(this).closest("table").find(".check-this:not(:disabled)").prop("checked",this.checked).trigger("change").closest("tr").toggleClass("selected",this.checked)})),$(document).on("change",".check-this",(function(){var t=$(this),n=t.closest("[data-id]")||t.parents("tr"),a=t.parents("#list")||t.parents("table"),i=$(".bulk-action");n.toggleClass("selected",this.checked),this.checked?(n.addClass("selected"),e.push(n.data("id")),i.attr("data-fields","id:"+e.join(","))):(n.removeClass("selected"),e.splice(e.indexOf(n.data("id")),1),i.attr("data-fields","id:"+e.join(","))),a.attr("data-selected",e),0===e.length?$(".bulk-action").prop("disabled",!0).addClass("disabled"):$(".bulk-action").prop("disabled",!1).removeClass("disabled")})),$(document).on("click",".bulk-action",(function(t){t.preventDefault();var n=$(this),a=n.attr("ajaxify")||n.attr("href"),i=n.data("message");return!n.attr("data-form")&&(!(void 0===a||!a.length)&&(e.length?void 0!==i?csk.ui.confirm(i,(function(){csk.ajax.request(a,{el:this,type:n.data("request")||"POST",data:{bulk:e,url:a},beforeSend:function(){n.prop("disabled")||n.prop("disabled",!0).addClass("disabled")},success:function(e,t,a){csk.ajax._response(e),n.removeProp("disabled").removeClass("disabled"),setTimeout(location.reload.bind(location),1500)}})}),null,n):void csk.ajax.request(a,{el:this,type:"POST",data:{bulk:e,url:a},beforeSend:function(){n.prop("disabled")||n.prop("disabled",!0).addClass("disabled")},complete:function(){n.removeProp("disabled").removeClass("disabled"),window.location.href=location.href}}):(csk.ui.alert(csk.i18n.default.make_selection,"info"),!1)))})),void 0!==$.fn.tooltip&&$("body").tooltip({selector:"[data-bs-toggle=tooltip], [rel=tooltip]"}),void 0!==$.fn.popover&&$("body").tooltip({selector:"[data-bs-toggle=popover], [rel=popover]"}),$(document).on("submit","form",(function(e){var t=$(this);return $("[type=submit]").prop("disabled",!0).addClass("disabled"),t.submit((function(){return!1})),!0})),void 0!==$.fn.garlic&&$("[rel=persist]").garlic(),$(document).on("click","a:not([data-confirm])[rel]",(function(e){var t=$(this),n=t.attr("rel"),a=t.attr("ajaxify")||t.attr("href");return void 0!==a&&a.length?!n.length||"async"!==n&&"async-post"!==n?void 0:(e.preventDefault(),csk.ajax.request(a,{el:this,type:"async"===n?"GET":"POST",beforeSend:function(){t.prop("disabled")||t.prop("disabled",!0).addClass("disabled")},success:function(e,n,a){csk.ajax._response(e),t.removeProp("disabled").removeClass("disabled"),setTimeout(location.reload.bind(location),1500)}}),!1):(e.preventDefault(),!1)})),$(document).on("submit","form[rel]",(function(e){var t=$(this),n=t.attr("rel"),a=t.attr("action");return void 0!==a&&a.length?"async"===n?(e.preventDefault(),csk.ajax.request(a,{el:this,type:"POST",data:t.serializeArray(),beforeSend:function(){t.prop("disabled")||t.find("[type=submit]").prop("disabled",!0).addClass("disabled")},complete:function(){t.find("[type=submit]").prop("disabled",!1).removeClass("disabled")}}),!1):void 0:(e.preventDefault(),!1)})),void 0!==$.fn.modal){var t=$(".modal.modal-land");t.length&&t.modal("show")}$(document).on("hidden.bs.modal",".modal:not(.modal-keep)",(function(e){$(this).remove()})),$(document).on("click","[data-confirm]:not([data-form])",(function(e){e.preventDefault();var t=$(this),n=t.attr("rel"),a=t.attr("ajaxify")||t.attr("href"),i=t.data("confirm");return!(void 0===a||!a.length)&&(void 0!==i&&i.length||(i="Are you sure?"),csk.ui.confirm(i,(function(){void 0!==n&&n.length?csk.ajax.request(a,{el:this,type:"async"===n?"GET":"POST",beforeSend:function(){t.prop("disabled")||t.prop("disabled",!0).addClass("disabled")},success:function(e,n,a){csk.ajax._response(e),t.removeProp("disabled").removeClass("disabled"),setTimeout(location.reload.bind(location),1500)}}):window.location.href=a}),null,t))})),$(document).on("click","[data-action]",(function(e){e.preventDefault();var t=$(this),n=t.data("action")||-1,a=t.data("target")||undefined,i=t.data("name")||t.attr("aria-label")||"this",o=t.attr("ajaxify")||t.attr("href")||undefined;if(n<=0)return console.log("error action: "+n),!1;if(void 0===a||!a.length||void 0===csk[a])return console.log("error target: "+a),!1;if(void 0===o||!o.length)return console.log("error href: "+o),!1;var s=csk.i18n[a][n]||undefined;void 0===s&&void 0===(s=csk.i18n[n]||undefined)&&(s="Are you sure you want to "+n+" %s?");var r=t.closest("tr");r.length&&r.siblings("tr").addClass("op-2"),void 0!==s&&s.length?csk.ui.confirm(sprintf(s,i),(function(){window.location.href=o}),(function(){r.length&&r.siblings("tr").removeClass("op-2")})):window.location.href=o})),$(document).on("click","[data-submit]",(function(e){e.preventDefault();var t=$(this),n=$(t.data("submit")),a=t.data("confirm");return void 0!==n&&(void 0!==a&&a.length?csk.ui.confirm(a,(function(){n.submit()}),null,t):void n.submit())})),$(document).on("click","[data-form]",(function(e){e.preventDefault();var t=$(this),n=t.data("form"),a=t.data("fields"),i=t.data("confirm");return!(void 0===n||!n.length)&&(void 0!==a&&a.length&&(a=csk.ui.prepFields(a)),void 0!==i&&i.length?csk.ui.confirm(i,(function(){csk.submit(n,a)}),null,t):void csk.submit(n,a))})),$(document).on("hidden.bs.modal","#theme-modal",(function(e){var t=csk.config.currentURL;t.indexOf("?")>0&&(t=t.substring(0,t.indexOf("?"))),window.history.pushState({href:t},"",t),$(this).remove()})),"function"==typeof $.fn.dropzone&&($(".dropZone").each((function(){var e=$(this),t=e.data("upload");void 0!==t&&t.length&&e.dropzone({url:t,clickable:"#upload",init:function(){this.on("addedfile",(function(){$(".dz-message").remove()})),this.on("success",(function(e,t){if("object"!=typeof(e=t.results))return!1;var n=document.getElementById("attachment-template").innerHTML,a=Handlebars.compile(n)(e);$(a).hide().prependTo(".dropZone").fadeIn("slow")})),this.on("error",(function(e,t){csk.ui.alert((null==t?void 0:t.message)||t,"error")})),this.on("complete",(function(e){this.removeFile(e)}))}})})),$(document).on("hidden.bs.modal","#media-modal",(function(e){var t=csk.config.currentURL;t.indexOf("?")>0&&(t=t.substring(0,t.indexOf("?"))),window.history.pushState({href:t},"",t),$(this).remove()})))}))})(window.jQuery||window.Zepto,window,document);
