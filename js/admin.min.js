/*!
 * Skeleton Back-End - Admin JS (https://www.ianhub.net/)
 * Copyright 2025 Kader Bouyakoub (https://github.com/bkader)
 */!function($,window,document,undefined){"use strict";var csk=window.csk=window.csk||{};csk.i18n=csk.i18n||{},"undefined"!=typeof bootbox&&(bootbox.setDefaults({backdrop:!0,closeButton:!1,locale:csk.config.lang.code,size:"small"}),bootbox.setLocale(csk.config.lang.code||"en")),csk.ui={scrollToTopVisible:!1,alertClasses:["info","success","warning","danger"],confirm:function(message,trueCallback,falseCallback,elem){if((message.startsWith("lang:")||message.startsWith("i18n:"))&&void 0!==csk.i18n&&(message=eval("csk.i18n."+message.substring(5))||message),"object"==typeof elem){var name=elem.data("name")||elem.attr("aria-label");name?.length&&(message=sprintf(message,name))}"undefined"!=typeof bootbox?bootbox.confirm({message:message,buttons:{confirm:{className:"btn btn-primary btn-sm"},cancel:{className:"btn btn-default btn-sm"}},callback:function(e){bootbox.hideAll(),!0===e&&"function"==typeof trueCallback?trueCallback(!0):"function"==typeof falseCallback&&falseCallback(!0)}}):confirm(message)&&"function"==typeof trueCallback?trueCallback(!0):"function"==typeof falseCallback&&falseCallback(!0)},alert:function(e,t="info"){if("string"!=typeof e||!e.length)return;if(t="critical"===(t=t?.toLowerCase()||"info")?"error":t,"undefined"!=typeof toastr){(toastr[t]||toastr.info).call(toastr,e.trim());return}t=csk.ui.alertClasses.includes(t)?t:"info";let i=document.getElementById("csk-alert-template")?.content?.querySelector("div")?.cloneNode(!0);if(i){i.classList.add("alert","alert-"+t,"alert-dismissible"),i.prepend(e.trim()),(document.querySelector("#wrapper>.container")||document.body).prepend(i),csk.ui.autoHideAlert($(i));return}window.alert(e.replace(/(<([^>]+)>)/ig,"").trim())},autoHideAlert:function(e){if(e.hasClass("alert-keep")||e.hasClass("alert-danger")||e.hasClass("alert-warning"))return;let t=Math.min(1e4,4e3+50*e.text().trim().length);e.delay(t).slideUp(500,function(){e.alert("close").remove()})},reload:function(e,t,i){if(!(e=e||"#wrapper").length)return!1;!1!==t&&$("#navbar-admin").load(csk.config.currentURL+" #navbar-admin > *"),$(e).load(csk.config.currentURL+" "+e+" > *",i)},inViewport:function(e){var t=e.getBoundingClientRect();return t.bottom>=0&&t.right>=0&&t.top<=(window.innerHeight||document.documentElement.clientHeight)&&t.left<=(window.innerWidth||document.documentElement.clientWidth)},addListener:function(e,t){window.addEventListener?window.addEventListener(e,t):window.attachEvent("on"+e,t)},delegate:function(e,t,i){document.addEventListener(e,function(e){let n=e.target.closest(t);n&&i.call(n,e)})},lazyLoad:function(){for(var e=$("[data-src]"),t=0;t<e.length;t++){var i=e[t];if(!csk.ui.inViewport(i)||"object"!=typeof i)return;$(i).is("img")?(i.src=i.getAttribute("data-src")||i.src,i.onload=function(){this.removeAttribute("data-src")}):"function"==typeof $(i).css&&($(i).css("background-image","url("+i.getAttribute("data-src")+")"),i.removeAttribute("data-src"))}},scrollToTop:function(){let e=document.body.querySelector(".scroll-to-top");document.documentElement.scrollTop>100?csk.ui.scrollToTopVisible||(csk.ui.fadeIn(e),csk.ui.scrollToTopVisible=!0):csk.ui.scrollToTopVisible&&(csk.ui.fadeOut(e),csk.ui.scrollToTopVisible=!1)},fadeOut:function(e){e.style.opacity=1,function t(){(e.style.opacity-=.1)<0?e.style.display="none":requestAnimationFrame(t)}()},fadeIn:function(e,t){e.style.opacity=0,e.style.display=t||"block",function t(){var i=parseFloat(e.style.opacity);(i+=.1)>1||(e.style.opacity=i,requestAnimationFrame(t))}()},prepFields:function(e){for(var t,i={},n=e.split(";"),a=0;a<n.length;a++)i[(t=n[a].split(":"))[0]]=t[1];return i},getUrlParams:function(e){e=e||window.location.href;for(var t,i={},n=e.slice(e.indexOf("?")+1).split("&"),a=0;a<n.length;a++)i[(t=n[a].split("="))[0]]=t[1];return i},getUrlParam:function(e){var t,i,n=window.location.search.substring(1).split("&");for(i=0;i<n.length;i++)if((t=n[i].split("="))[0]===e)return undefined===t[1]||decodeURIComponent(t[1]);return!1},clipboard:function(e){var t=e.getAttribute("data-text");if(!t?.length)return!1;navigator.clipboard.writeText(t),csk.ui.alert(csk.i18n.media.copied,"success")},selectOff:function(e){let t=e.target.closest(".no-select-on-click");t&&(document.body.style.userSelect="none")},selectOn:function(e){document.body.style.userSelect=""},dataTable:function(e,t){if(void 0===$.fn.DataTable){console.error("Please load DataTables before using 'csk.ui.dataTable'.");return}let i={processing:!0,serverSide:!0,ajax:{url:$(e).data("source"),type:"POST"},order:[[0,"asc"]],pageLength:csk.config.perPage,columnDefs:[{targets:"no-sort",orderable:!1}]};return $(e).DataTable($.extend(!0,{},i,t))},highlightByHash:function(){let e=window.location.hash;if(!e)return;let t=document.getElementById(e.substring(1));if(!t)return;let i=t.closest(".form-group, .mb-3, .form-check"),n=i||t;n.classList.add("highlight-focus"),n.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"}),setTimeout(()=>n.classList.remove("highlight-focus"),4e3)},toggleDisabled:function(e,t){e&&(e instanceof HTMLElement?e=[e]:e instanceof NodeList?e=Array.from(e):window.jQuery&&e instanceof jQuery?e=e.toArray():Array.isArray(e)||"number"!=typeof e.length||(e=Array.from(e)),Array.isArray(e)&&e.forEach(function(e){e instanceof HTMLElement&&(e.disabled=t,t?(e.setAttribute("disabled","disabled"),e.classList.add("disabled")):(e.removeAttribute("disabled"),e.classList.remove("disabled")))}))}},csk.ui.highlightByHash(),csk.ui.addListener("mousedown",csk.ui.selectOff),csk.ui.addListener("mouseup",csk.ui.selectOn),csk.ui.addListener("load",csk.ui.lazyLoad),csk.ui.addListener("scroll",csk.ui.lazyLoad),csk.ui.addListener("scroll",csk.ui.scrollToTop),csk.ui.addListener("click",function(e){e.target.closest(".scroll-to-top")&&(e.preventDefault(),window.scrollTo({top:0,behavior:"smooth"}))}),csk.ajax={requests:[],requesting:!1,context:undefined,request:function(e,t){(t=t||{}).context;var i=t.type||"GET";t=$.extend({url:e,method:i,type:i,async:!0,cache:!1,headers:{"X-Requested-With":"XMLHttpRequest"},dataType:"json",success:function(e,t,i){csk.ajax._response(e)},error:function(e,t,i){var n=e.responseJSON||undefined;n?.message?.length&&csk.ui.alert(n.message,n.status||"error")}},t),this.requests.push(t),this._execute()},stop:function(){this.requests=[]},_execute:function(){if(0!=this.requests.length&&!0!=this.requesting){var e=this.requests.splice(0,1)[0],t=e.complete,i=this;e._execute&&e._execute(e),e.complete=function(){t&&t.apply(this,arguments),i.requesting=!1,i._execute()},this.requesting=!0,$.ajax(e)}},_response:function(e){var e=e||{},t=this;if(csk.ajax.context=t,e?.message?.length&&csk.ui.alert(e.message,"success"),e.scripts?.length)for(var i=e.scripts.length,n=0;n<i;n++)try{Function(e.scripts[n]).call(t)}catch(a){console.error(a)}}},["get","post","put","patch","delete"].forEach(function(e){csk.ajax[e]||(csk.ajax[e]=function(t,i){return console.log(t),(i=i||{}).type=i.method=e.toUpperCase(),this.request(t,i)})}),csk.sendFile=function(e,t){var i=new FormData,n=$(t).data("upload");if(!n?.length)return!1;i.append("file",e),csk.ajax.request(n,{type:"POST",data:i,processData:!1,contentType:!1,complete:function(e,i){if("success"===i){var n=e.responseJSON;$(t).hasClass("summernote")&&$(t).summernote("insertImage",n.results.url),$("<input>").attr({type:"hidden",name:"medias[]",value:n.results.id}).appendTo(t),csk.ui.toggleDisabled($(t).closest("form").find("[type=submit]"),!1)}}})},csk.submit=function(e,t){var i=$("<form>",{action:e,method:"post"});$.each(t,function(e,t){$("<input>").attr({type:"hidden",name:e,value:t}).appendTo(i)}),i.appendTo("body").submit()},csk.ping={init:function(e){var t={url:"keep-alive",timer:6e5};return this.options=$.extend(t,e),csk.ping._ping.apply(this),this},stop:function(){this.nextPing&&clearTimeout(this.nextPing)},_ping:function(){var e=this;this.nextPing=setTimeout(function(){csk.ajax.request(e.options.url,{type:"POST"}),csk.ping._ping.apply(e)},e.options.timer)}},csk.media={editor:null,browse:function(e){csk.media.editor=e;let t=$("#media-modal"),i=$("#media-browser"),n=$("#media-insert-btn");i.html('<div class="text-center py-5 text-muted">'+csk.i18n.default.loading+"...</div>"),n.prop("disabled",!0),csk.ajax.request(csk.config.adminURL+"/ajax/media",{type:"GET",success:function(e){if(e.results&&e.results.length){let t="";e.results.forEach(e=>{var i=document.getElementById("media-template").innerHTML;t+=Handlebars.compile(i)(e)}),i.html(t)}else i.html('<div class="text-center py-5 text-muted">'+csk.i18n.default.no_data+"</div>")}}),t.modal("show")},select:function(){$("#media-modal .media-item").removeClass("selected"),$(this).addClass("selected"),$("#media-modal #media-insert-btn").prop("disabled",!1)},insert:function(){let e=$("#media-modal .media-item.selected");if(!e.length||!csk.media.editor)return;let t=$(csk.media.editor);if(!t.hasClass("summernote")){console.warn("Invalid editor reference:",t);return}let i=e.data("url");t.summernote("insertImage",i),$("#media-modal").modal("hide")},init:function(){csk.media._initialized||(csk.ui.delegate("click","#media-modal .media-item",csk.media.select),csk.ui.delegate("click","#media-modal #media-insert-btn",csk.media.insert),csk.media._initialized=!0)}},$(document).ready(function(){$.fn.ping=function(e){return csk.ping[e]?csk.ping[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void $.error("The method "+e+" doesn't exist in $.fn.ping"):csk.ping.init.apply(this,arguments)},void 0!==csk.config&&$.fn.ping({url:csk.config.baseURL+"keep-alive",timer:18e5}),$(".alert-dismissible").each(function(){csk.ui.autoHideAlert($(this))}),"undefined"!=typeof toastr?toastr.options={rtl:"rtl"===csk.config.lang.direction,closeButton:!0,positionClass:"toast-top-center",hideDuration:"300",timeOut:"2500",showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"}:void 0!==$.fn.toast&&$(".toast").each(function(){$(this).toast("show").on("hidden.bs.toast",function(){$(this).remove()})}),void 0!==$.fn.select2&&$("select.select2").each(function(){var e=$(this),t={width:"100%"},i=e.data("placeholder")||e.attr("placeholder");!i?.length||e.prop("multiple")||(t.placeholder=i,t.allowClear=!0,e.find('option[value=""]').length||e.prepend("<option></option>")),e.hasClass("select2-modal")&&(t.dropdownParent=$(".modal")),e.select2(t)}),$(".custom-file-input").on("change",function(){var e=$(this).val().split("\\").pop();$(this).siblings(".custom-file-label").addClass("selected").html(e)}),"object"==typeof $.ui&&$(".sortable").each(function(){var e=$(this);e.sortable({containment:".sortable",cursor:"move",tolrance:"pointer",scroll:!0,revert:100,opacity:.65,axis:e.data("axis")||"y",update:function(e,t){var i=$(".sortable-form");if("object"==typeof i){var n=$(this).sortable("toArray",{attribute:"data-id"});i.data("fields","id:"+n.join(","))}}})}),$(document).on("input","input.uppercase",function(e){e.target.value=e.target.value.toUpperCase()});let e=new Set;if($(document).on("change click",".check-all",function(e){let t=$(this),i=t.is(":checkbox");if("click"===e.type&&i)return;let n=i?t.is(":checked"):!t.hasClass("active"),a=t.closest("table, form, .list-group").length?t.closest("table, form, .list-group"):$(document),o=a.find(".check-this").not(":disabled");o.each(function(){let e=$(this),t=e.closest("tr, .list-group-item");e.is(":checkbox")?e.prop("checked",n).trigger("change"):e.toggleClass("active",n),t.toggleClass("selected",n)}),i||(e.preventDefault(),t.toggleClass("active",n))}),$(document).on("change",".check-this",function(){var t=$(this),i=t.closest("[data-id]")||t.parents("tr"),n=t.parents("#list")||t.parents("table"),a=$(".bulk-action"),o=i.data("id");i.toggleClass("selected",this.checked),this.checked?(i.addClass("selected"),e.add(o)):(i.removeClass("selected"),e.delete(o)),a.data("fields","id:"+Array.from(e).join(",")),n.data("selected",e),csk.ui.toggleDisabled(document.querySelectorAll(".bulk-action"),0===e.size)}),$(document).on("click",".bulk-action",function(t){t.preventDefault();var i=$(this),n=i.attr("ajaxify")||i.attr("href"),a=i.data("message");return!i.data("form")&&!!n?.length&&(e.size?void 0!==a?csk.ui.confirm(a,function(){csk.ajax.request(n,{el:this,type:i.data("request")||"POST",data:{id:Array.from(e).join(","),url:n},beforeSend:function(){i.prop("disabled")||csk.ui.toggleDisabled(i[0],!0)},success:function(e,t,n){csk.ajax._response(e),csk.ui.toggleDisabled(i[0],!1),setTimeout(location.reload.bind(location),2e3)}})},null,i):void csk.ajax.request(n,{el:this,type:"POST",data:{id:e,url:n},beforeSend:function(){i.prop("disabled")||csk.ui.toggleDisabled(i[0],!0)},complete:function(){csk.ui.toggleDisabled(i[0],!1),window.location.href=location.href}}):(csk.ui.alert(csk.i18n.default.make_selection,"info"),!1))}),void 0!==$.fn.tooltip&&$("body").tooltip({selector:"[data-bs-toggle=tooltip], [rel=tooltip]"}),void 0!==$.fn.popover&&$("body").tooltip({selector:"[data-bs-toggle=popover], [rel=popover]"}),$(document).on("submit","form",function(e){let t=$(this);return csk.ui.toggleDisabled(t.find("[type=submit]"),!0),t.on("submit",()=>!1),!0}),void 0!==$.fn.garlic&&$("[rel=persist]").garlic(),$(document).on("click","a:not([data-confirm])[rel]",function(e){var t=$(this),i=t.attr("rel"),n=t.attr("ajaxify")||t.attr("href");return n?.length?i.length&&("async"===i||"async-post"===i)?(e.preventDefault(),csk.ajax.request(n,{el:this,type:"async"===i?"GET":"POST",beforeSend:function(){!t.prop("disabled")&&csk.ui.toggleDisabled(t[0],!0)},success:function(e,i,n){csk.ajax._response(e),csk.ui.toggleDisabled(t[0],!1),setTimeout(location.reload.bind(location),1500)}}),!1):void 0:(e.preventDefault(),!1)}),$(document).on("submit","form[rel]",function(e){var t=$(this),i=t.attr("rel"),n=t.attr("ajaxify")||t.attr("action");return n?.length?"async"===i?(e.preventDefault(),csk.ajax.request(n,{el:this,type:"POST",data:t.serializeArray(),beforeSend:function(){!t.prop("disabled")&&csk.ui.toggleDisabled(t.find("[type=submit]"),!0)},complete:function(){t.trigger("reset"),csk.ui.toggleDisabled(t.find("[type=submit]"),!1),setTimeout(location.reload.bind(location),1500)}}),!1):void 0:(e.preventDefault(),!1)}),void 0!==$.fn.modal){var t=$(".modal.modal-land");t.length&&t.modal("show")}$(document).on("hidden.bs.modal",".modal:not(.modal-keep)",function(e){$(this).remove()}),$(document).on("click","[data-confirm]:not([data-form])",function(e){e.preventDefault();var t=$(this),i=t.attr("rel"),n=t.attr("ajaxify")||t.attr("href"),a=t.data("fields"),o=t.data("confirm");return!!n?.length&&(a?.length&&(a=csk.ui.prepFields(a)),o?.length||(o="Are you sure?"),csk.ui.confirm(o,function(){i?.length?csk.ajax.request(n,{el:this,type:"async"===i?"GET":"POST",data:a,beforeSend:function(){!t.prop("disabled")&&csk.ui.toggleDisabled(t[0],!0)},success:function(e,i,n){csk.ajax._response(e),csk.ui.toggleDisabled(t[0],!1),setTimeout(location.reload.bind(location),1500)}}):window.location.href=n},null,t))}),$(document).on("click","[data-action]",function(e){e.preventDefault();var t=$(this),i=t.data("action")||-1,n=t.data("target")||undefined,a=t.data("name")||t.attr("aria-label")||"this",o=t.attr("ajaxify")||t.attr("href")||undefined;if(i<=0)return console.error("error action: "+i),!1;if(!n?.length||void 0===csk[n])return console.error("error target: "+n),!1;if(!o?.length)return console.error("error href: "+o),!1;var r=csk.i18n[n][i]||undefined;void 0===r&&void 0===(r=csk.i18n[i]||undefined)&&(r="Are you sure you want to "+i+" %s?");var s=t.closest("tr");if(s.length&&s.siblings("tr").addClass("op-2"),r?.length){csk.ui.confirm(sprintf(r,a),function(){window.location.href=o},function(){s.length&&s.siblings("tr").removeClass("op-2")});return}window.location.href=o}),$(document).on("click","[data-submit]",function(e){e.preventDefault();var t=$(this),i=$(t.data("submit")),n=t.data("confirm");if(void 0===i)return!1;if(!n?.length){i.submit();return}return csk.ui.confirm(n,function(){i.submit()},null,t)}),$(document).on("click","[data-form]",function(e){e.preventDefault();var t=$(this),i=t.data("form"),n=t.data("fields"),a=t.data("confirm");if(!i?.length)return!1;if(n?.length&&(n=csk.ui.prepFields(n)),!a?.length){csk.submit(i,n);return}return csk.ui.confirm(a,function(){csk.submit(i,n)},null,t)}),$(document).on("hidden.bs.modal hidden.bs.offcanvas","#media-detail, #theme-detail",function(e){var t=new URL(window.location.href);for(let i of Array.from(t.searchParams.keys()))"item"===i.toLowerCase()&&t.searchParams.delete(i);window.history.pushState({href:t.href},"",t.href),$(this).remove()}),"function"==typeof $.fn.dropzone&&$(".dropZone").each(function(){var e=$(this),t=e.data("upload");t?.length&&e.dropzone({url:t,clickable:"#upload",init:function(){this.on("addedfile",function(){$(".dz-message").remove()}),this.on("success",function(e,t){var e=t.results;if("object"!=typeof e)return!1;var i=document.getElementById("media-template").innerHTML;$(Handlebars.compile(i)(e)).hide().prependTo(".dropZone").fadeIn("slow")}),this.on("error",function(e,t){csk.ui.alert((null==t?void 0:t.message)||t,"error")}),this.on("complete",function(e){this.removeFile(e)})}})})})}(window.jQuery||window.Zepto,window,document);
